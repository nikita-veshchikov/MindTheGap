\section{Introduction}
Nowadays, the explosive growth of the ``Internet of Things'' (IoT) is reshaping modern society, pervading its infrastructure and communications.
The rapid price drop in IoT components has transformed everyday products, enhancing them with network connectivity and information exchange capabilities. Amidst this new status quo, devices, ranging from cheap sensors to expensive vehicles, are required to maintain a heightened level of theoretical and physical security.

For instance, side-channel attacks (SCA) allow adversaries to recover sensitive data, 
by observing and analyzing the physical characteristics and emanations of a cryptographic 
implementation~\cite{DBLP:conf/crypto/KocherJJ99}. 
Such physical attacks motivated research towards countermeasures 
that perform noise amplification\todo{reviewer: ``towards countermeasures that perform \_a.o.\_ noise amplification''}, 
thus hindering the adversary's recovery capabilities. 
A common choice for provably secure, noise-amplifying software countermeasure is 
masking~\cite{DBLP:conf/crypto/ChariJRR99,DBLP:conf/crypto/IshaiSW03}. 
Masking employs secret-sharing techniques that establish theoretical security 
against the value-based leakage model. Rephrasing, masking secures implementations 
against adversaries that can only extract information about the value being 
processed at a given time. This underlying assumption is often referred to as the 
\emph{independent leakage assumption} (ILA)~\cite{DBLP:conf/eurocrypt/RenauldSVKF11}. 
Unfortunately, the exact values under manipulation are not always visible at a given 
layer of abstraction, e.g. at assembly code and such a limited adversarial model is 
not applicable in many practical, software-based scenarios. For instance, devices often 
exhibit \emph{distance-based leakages}, which can reduce the security of the masking 
countermeasure~\cite{DBLP:conf/cardis/BalaschGGRS14, DBLP:journals/iacr/GrootPPSB16}. 
Likewise, coupling effects~\cite{DBLP:conf/eurocrypt/RenauldSVKF11} and 
glitches~\cite{DBLP:conf/ches/MangardS06} can pose similar security hazards.

This work attempts to bridge the gap between theory and practice in the masking countermeasure with the following threefold contribution. First, we investigate several effects that violate ILA in an ATMega163 microcontroller and subsequently, we establish solutions that mitigate these issues. Second, we use this knowledge in order to build an assembly-oriented tool that is capable of detecting ILA violations in AVR-based masked implementations. Third, assisted by the developed tool, we craft the first (to our knowledge) 1st-order masked implementation in ATMega163 that is capable of resisting 1st-order, univariate attacks. In other words, we enforce the ILA in order to severely limit the informativeness of 1st-order leakages, forcing the adversary to resort to 2nd-order attacks. As a proof of concept, we develop a ``hardened" 1st-order, ISW-based~\cite{DBLP:conf/crypto/IshaiSW03}, bitsliced Sbox for the RECTANGLE cipher~\cite{DBLP:journals/chinaf/ZhangBLR0V15}. The ``hardened'' implementation requires 1319 clock cycles, a 15-fold increase compared to a ``naive" 1st-order, ISW-based, bitsliced Sbox of the same cipher. 

The rest of this paper is organized as follows. In Section~\ref{sec:background}, we provide preliminaries w.r.t. masking, the experimental setup and the evaluation techniques we employ. In Section~\ref{sec:ila_effects} we offer a detailed description of all the ILA-breaching effects that we have identified in ATMega163. 
Section~\ref{sec:tool} discusses the development of the assembly verification tool. Section~\ref{sec:rectangle} details the construction of a ``hardened'' RECTANGLE, 1st-order masked Sbox for ATMega163. We conclude and discuss future work in Section~\ref{sec:conclusions}.


